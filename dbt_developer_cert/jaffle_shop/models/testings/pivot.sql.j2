/*
  This file was automatically generated by dbt

        Source: models\testings\pivot.sql
      Compiled: target\.lsp\compiled\models\testings\pivot.sql
  Last updated: 2/23/2026, 6:36:00 PM
*/

with successful_payment as (
    SELECT * FROM analytics.analytics_prod.stg_stripe__payments
    WHERE status = 'success'
)


select
        sum(
            case 
                when payment_method = 'credit_card' 
                then amount 
                else 0 
            end
        ) as credit_card_amount,
    
        sum(
            case 
                when payment_method = 'coupon' 
                then amount 
                else 0 
            end
        ) as coupon_amount,
    
        sum(
            case 
                when payment_method = 'gift_card' 
                then amount 
                else 0 
            end
        ) as gift_card_amount,
    
        sum(
            case 
                when payment_method = 'bank_transfer' 
                then amount 
                else 0 
            end
        ) as bank_transfer_amount
    

from successful_payment